<div class="department-form-container">
  <p-toast />

  <div class="page-header">
    <div class="header-content">
      <h1><i class="pi pi-plus-circle"></i> Nuevo Departamento</h1>
      <p>Complete el formulario para agregar un nuevo departamento</p>
    </div>
  </div>

  <div class="form-card">
    <p-card>
      <form [formGroup]="departmentForm" (ngSubmit)="onSubmit()">
        <div class="form-section">
          <h2><i class="pi pi-info-circle"></i> Información General</h2>
          
          <div class="form-grid">
            <div class="form-field">
              <label for="nombre">Nombre del Departamento *</label>
              <input 
                pInputText 
                id="nombre" 
                formControlName="nombre"
                placeholder="Ej: Tecnología"
                [class.p-invalid]="hasError('nombre')" />
              @if (hasError('nombre')) {
                <small class="p-error">{{ getErrorMessage('nombre') }}</small>
              }
            </div>

            <div class="form-field">
              <label for="gerente">Gerente/Responsable *</label>
              <input 
                pInputText 
                id="gerente" 
                formControlName="gerente"
                placeholder="Nombre del gerente"
                [class.p-invalid]="hasError('gerente')" />
              @if (hasError('gerente')) {
                <small class="p-error">{{ getErrorMessage('gerente') }}</small>
              }
            </div>

            <div class="form-field full-width">
              <label for="descripcion">Descripción *</label>
              <textarea 
                pTextarea 
                id="descripcion" 
                formControlName="descripcion"
                rows="3"
                placeholder="Descripción del departamento y sus funciones"
                [class.p-invalid]="hasError('descripcion')">
              </textarea>
              @if (hasError('descripcion')) {
                <small class="p-error">{{ getErrorMessage('descripcion') }}</small>
              }
            </div>
          </div>
        </div>

        <div class="form-section">
          <h2><i class="pi pi-chart-line"></i> Información Operativa</h2>
          
          <div class="form-grid">
            <div class="form-field">
              <label for="numeroEmpleados">Número de Empleados *</label>
              <p-inputNumber
                id="numeroEmpleados"
                formControlName="numeroEmpleados"
                [min]="0"
                placeholder="0"
                [class.p-invalid]="hasError('numeroEmpleados')">
              </p-inputNumber>
              @if (hasError('numeroEmpleados')) {
                <small class="p-error">{{ getErrorMessage('numeroEmpleados') }}</small>
              }
            </div>

            <div class="form-field">
              <label for="presupuesto">Presupuesto Anual (Lempiras) *</label>
              <p-inputNumber
                id="presupuesto"
                formControlName="presupuesto"
                mode="currency"
                currency="HNL"
                locale="es-HN"
                placeholder="0.00"
                [class.p-invalid]="hasError('presupuesto')">
              </p-inputNumber>
              @if (hasError('presupuesto')) {
                <small class="p-error">{{ getErrorMessage('presupuesto') }}</small>
              }
            </div>

            <div class="form-field">
              <label for="fechaCreacion">Fecha de Creación *</label>
              <div class="card flex justify-center">
                <p-datepicker
                  id="fechaCreacion"
                  formControlName="fechaCreacion"
                  [showIcon]="true"
                  dateFormat="dd/mm/yy"
                  placeholder="Seleccione una fecha"
                  [class.p-invalid]="hasError('fechaCreacion')">
                </p-datepicker>
              </div>
              @if (hasError('fechaCreacion')) {
                <small class="p-error">{{ getErrorMessage('fechaCreacion') }}</small>
              }
            </div>

            <div class="form-field">
              <label for="estado">Estado *</label>
              <p-select 
                id="estado"
                formControlName="estado"
                [options]="estados"
                placeholder="Seleccione un estado"
                [class.p-invalid]="hasError('estado')">
              </p-select>
              @if (hasError('estado')) {
                <small class="p-error">{{ getErrorMessage('estado') }}</small>
              }
            </div>
          </div>
        </div>

        <div class="form-actions">
          <button 
            pButton 
            type="button" 
            label="Cancelar" 
            icon="pi pi-times"
            class="p-button-secondary"
            (click)="onCancel()">
          </button>
          <button 
            pButton 
            type="submit" 
            label="Guardar Departamento" 
            icon="pi pi-check"
            [disabled]="submitted && departmentForm.invalid">
          </button>
        </div>

        @if (submitted && departmentForm.invalid) {
          <div class="error-summary">
            <p-message 
              severity="error" 
              text="Por favor corrija los errores del formulario antes de continuar">
            </p-message>
          </div>
        }
      </form>
    </p-card>
  </div>
</div>

